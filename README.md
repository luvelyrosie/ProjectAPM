# ProjectAPM

ProjectAPM — это приложение на FastAPI для управления заказами и задачами. Оно включает аутентификацию пользователей, операции CRUD для заказов и задач, а также базу данных PostgreSQL. Проект полностью контейнеризован с помощью Docker, что позволяет легко запускать и тестировать его на любой машине.

---

## Функции

* Регистрация и аутентификация пользователей (JWT)
* CRUD операции для заказов и задач
* Доступ на основе ролей (админ/оператор)
* Полная контейнеризация с Docker
* Миграции базы данных с Alembic

---

## Деплой и доступ к приложению

Проект доступен онлайн по ссылке:  

[ProjectAPM на Railway](https://projectapm-production.up.railway.app/)

Основная страница заказов:  

[Orders Page](https://projectapm-production.up.railway.app/orders/page)

Тестовый Администратор

Чтобы протестировать создание заказов и задач я создала тестового администратора, вы можете использовать тестового администратора:
\
Имя пользователя: admin

Email: admin@admin

Пароль: admin123

С этим пользователем вы сможете:

Создавать новые заказы

Просматривать все заказы

Создавать задачи для заказов

Менять статус задач

Просматривать детали заказов и задач

После входа администратора вы попадёте на главную страницу заказов:

> **Важно:** для создания заказов и задач необходимо использовать пользователя с ролью `admin`.

---

## Установка и запуск через Docker


## Требования

* [Docker](https://www.docker.com/get-started) установлен
* [Docker Compose](https://docs.docker.com/compose/install/)
* Необязательно: Python 3.11+ для локальной разработки

---

1. Клонируйте репозиторий:

```bash
git clone https://github.com/luvelyrosie/ProjectAPM.git
cd ProjectAPM
```

2. Постройте и запустите контейнеры:

```bash
docker compose build
docker compose up -d
```

3. Примените миграции базы данных:

```bash
docker compose run --rm web bash -c "cd backend && alembic upgrade head"
```

---

## Доступ к приложению

* FastAPI работает на порту 8000. Откройте в браузере или API-клиенте:

```
http://localhost:8000
```

* Главная страница заказов:

```
http://localhost:8000/orders/page
```

4. Создайте пользователя с ролью администратора, чтобы иметь возможность создавать заказы, задачи и управлять всем функционалом приложения.


* role: admin


* Swagger UI документация:

```
http://localhost:8000/docs
```

* Redoc API документация:

```
http://localhost:8000/redoc
```

---

## Миграции Alembic

* Скрипты миграций находятся в `backend/alembic/versions`.
* Чтобы создать новую миграцию:

```bash
docker compose run --rm web bash -c "cd backend && alembic revision -m 'ваше_сообщение'"
docker compose run --rm web bash -c "cd backend && alembic upgrade head"
```

---

## Замечания о базе данных

* Каждый разработчик получает **отдельную базу Postgres** через Docker.
* База создается автоматически при старте контейнера.
* Миграции Alembic создают все таблицы и колонки, включая роли пользователей и связи заказов/задач.
* Начальные данные можно добавить через админ-пользователя.

---

## Запуск локально (без Docker)

1. Установите зависимости:

```bash
pip install -r requirements.txt
```

2. Запустите приложение:

```bash
uvicorn backend.app.main:app --reload
```

3. Примените миграции:

```bash
alembic upgrade head
```

---

## Дополнительно

* Убедитесь, что Postgres запущен перед применением миграций.
* Пароль базы данных указан в `docker-compose.yml` и может быть безопасно изменен.
* Для новой установки Alembic создаст все таблицы и колонки, приложение будет готово к запуску.
